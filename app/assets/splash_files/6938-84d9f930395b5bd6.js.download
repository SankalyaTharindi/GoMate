"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6938],{4262:(e,t,r)=>{r.d(t,{i:()=>u});var a=r(54568),l=r(7620),s=r(10369),n=r(23812),o=r(98304);let i=e=>{let{handleClose:t,title:r,description:l,inset:s,action:i}=e;return(0,a.jsxs)("div",{className:"border-border-300 shadow-sm w-[300px] max-w-full bg-bg-000 rounded-xl p-5 border relative",children:[(0,a.jsx)("div",{className:"text-left mb-2 font-medium text-sm",children:r}),(0,a.jsx)("p",{className:"mb-2 text-sm",children:l}),!!s&&(0,a.jsx)("div",{className:"flex flex-col rounded-md bg-text-000 bg-opacity-5 p-4 font-mono text-xs text-text-300",children:s}),i&&(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(n.$,{variant:"primary",className:"mt-4 text-sm",onClick:i.onClick,disabled:i.disabled,loading:i.loading,children:i.label})}),(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)(n.$,{variant:"ghost",onClick:t,className:"h-9 w-9 !min-w-9",children:(0,a.jsx)(o.X,{})})})]})},u=e=>{var t,r,n;let{error:o,handleClose:u,sendMessage:d,isStreaming:c}=e,[f,m]=(0,l.useState)(!1),p=(0,s.A)(),h=function(e,t){switch(e.type){case"UnsupportedImports":return{title:t?t.formatMessage({defaultMessage:"Artifact failed to load",id:"NcDXiSfIPe"}):"Artifact failed to load",description:t?t.formatMessage({defaultMessage:"The generated artifact uses libraries we don’t support:",id:"HG0Hu8xIQA"}):"The generated artifact uses libraries we don’t support:",inset:[...e.unsupportedModules,...e.nonExistentIcons.map(e=>"{ ".concat(e,' } from "lucide-react"'))],subtext:t?t.formatMessage({defaultMessage:"The code itself may still work. To use it, you’ll need a development setup with these libraries installed.",id:"Et/uvuRBba"}):"The code itself may still work. To use it, you’ll need a development setup with these libraries installed."};case"RuntimeError":return{title:t?t.formatMessage({defaultMessage:"Error running artifact",id:"JU2kK1J3jY"}):"Error running artifact",description:t?t.formatMessage({defaultMessage:"An error occurred while trying to run the generated artifact.",id:"3RpkNRAyPc"}):"An error occurred while trying to run the generated artifact.",inset:[e.message],insetStyle:"danger"};case"FileNotFound":return{title:t?t.formatMessage({defaultMessage:"File not found",id:"gcaJtRf4b0"}):"File not found",description:t?t.formatMessage({defaultMessage:"The file “{fileName}” could not be found.",id:"0kOCGtB3eN"},{fileName:e.fileName}):"The file “".concat(e.fileName,"” could not be found."),subtext:t?t.formatMessage({defaultMessage:"Please check the file name and try again.",id:"/fdYJU5SMC"}):"Please check the file name and try again."};case"ClaudeCompletionError":return{title:t?t.formatMessage({defaultMessage:"Error in Claude completion",id:"ya5HK9oB9T"}):"Error in Claude completion",description:e.message};case"ArtifactStorageError":return{title:t?t.formatMessage({defaultMessage:"Error accessing shared data",id:"hjqZygykww"}):"Error accessing shared data",description:e.message}}}(o.error,p),g="> ".concat(h.description,"\n  ").concat(null!=(n=null==(t=h.inset)?void 0:t.map(e=>"> `".concat(e,"`")).join("\n"))?n:"","\n  \n\n  Can you fix this error in `").concat(o.artifactId,"`?"),y=d?{label:p.formatMessage({defaultMessage:"Try fixing with Claude",id:"wrcoZ2Zo0b"}),onClick:()=>{m(!0),null==d||d({prompt:g,attachments:[],files:[],syncSources:[]})},disabled:c,loading:f}:void 0;return(0,a.jsx)("div",{className:"absolute bottom-5 left-5 right-5",children:(0,a.jsx)(i,{title:h.title,description:h.description,handleClose:u,inset:(null==(r=h.inset)?void 0:r.length)?h.inset?(0,a.jsx)("ul",{children:h.inset.map((e,t)=>(0,a.jsx)("li",{children:e},t))}):null:void 0,action:y})})}},46879:(e,t,r)=>{r.d(t,{A:()=>A});var a=r(54568),l=r(23812),s=r(3075),n=r(10369),o=r(59666);let i=e=>{let{isOpen:t=!1,filename:r,onClose:i,onConfirm:u}=e,d=(0,n.A)();return(0,a.jsxs)(s.aF,{title:d.formatMessage({defaultMessage:"Download file",id:"k9qHCCLPA5"}),isOpen:t,onClose:i,children:[(0,a.jsxs)("p",{className:"break-words flex flex-col gap-1 pt-3 text-sm",children:[(0,a.jsx)(o.A,{defaultMessage:"Artifacts are created by other users and aren’t verified by Anthropic. Only download files you trust.",id:"MDebIUeu03"}),(0,a.jsx)("pre",{className:"font-mono text-wrap text-sm p-2 my-2 rounded border border-border-400 bg-bg-000",children:r})]}),(0,a.jsxs)(s.vW,{children:[(0,a.jsx)(l.$,{variant:"secondary",onClick:i,children:(0,a.jsx)(o.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(l.$,{onClick:u,children:(0,a.jsx)(o.A,{defaultMessage:"Download file",id:"k9qHCCLPA5"})})]})]})};var u=r(19094),d=r(64328),c=r(13750),f=r(21266),m=r(68067),p=r(7620);let h=e=>{let{isOpen:t=!1,onClose:r,onConfirm:i}=e,u=(0,n.A)(),[h,g]=(0,p.useState)(!1),y=(0,m.fS)("claude_create_pebble_stone"),{activeOrganization:v}=(0,d.YL)();return(0,p.useEffect)(()=>{!t||y&&(null==v?void 0:v.uuid)||r()},[t,y,null==v?void 0:v.uuid,r]),(0,a.jsxs)(s.aF,{title:u.formatMessage({defaultMessage:"Access shared data",id:"BgSBBhOmOQ"}),isOpen:t,onClose:r,children:[(0,a.jsx)("p",{className:"break-words flex flex-col gap-1 pt-3 text-sm",children:(0,a.jsx)(f.YX,{id:"velvet_cupcake_spark"})}),(0,a.jsx)("div",{className:"mt-4 mb-2",children:(0,a.jsx)(c.Sc,{label:(0,a.jsx)("span",{className:"text-sm text-text-100",children:(0,a.jsx)(o.A,{defaultMessage:"Remember my choice for this session",id:"ihRWxb7Azt"})}),checked:h,onChange:g})}),(0,a.jsxs)(s.vW,{children:[(0,a.jsx)(l.$,{variant:"secondary",onClick:()=>r(h),children:(0,a.jsx)(o.A,{defaultMessage:"Deny",id:"htvX+Z11l+"})}),(0,a.jsx)(l.$,{onClick:()=>i(h),children:(0,a.jsx)(o.A,{defaultMessage:"Allow",id:"y/bmsG8rnv"})})]})]})};var g=r(44995),y=r(57291),v=r(56929),x=r(72902),b=r(39109),w=r(61295),C=r(19354),j=r(16159),k=r(86667),S=r(73356),M=r(97905);let A=(0,p.forwardRef)((e,t)=>{let{content:r,className:s,type:c,onSandboxConfirmation:f,onDOMContentLoaded:A,capabilities:P,onReportError:N,onSetContent:R,onRefresh:E,externalLinkBehavior:Z,onOpenExternalLinkRequest:T,onTrackInteraction:_,showLoginModal:H,lazy:O=!0,zoom:L=1,artifactContext:I,ArtifactMcpModal:q,isChatStreaming:F}=e,U=(0,n.A)(),{userContentRendererUrl:B}=(0,g._r)(),D=(0,m.fS)("claude_create_marble"),G=(0,m.fS)("claudeai_anorak_senator_shoreline"),[z,$]=(0,p.useState)(!1),Y=(0,p.useRef)(null),J="".concat(B).concat((null==I?void 0:I.uuid)&&"published_artifact"===I.type?"/artifact/"+I.uuid:""),X=window.location.hostname,K=new URLSearchParams;K.set("domain",X),N&&K.set("errorReportingMode","parent"),G&&K.set("formattedSpreadsheets","true");let W=K.toString()?"".concat(J,"?").concat(K.toString()):J;(0,p.useEffect)(()=>{let e=Y.current;if(e&&navigator.userAgent.toLowerCase().includes("firefox")){e.setAttribute("data-no-service-worker","true");let t=setTimeout(()=>{e.sandbox&&e.src&&(e.sandbox.value="allow-scripts allow-same-origin",e.setAttribute("referrerpolicy","no-referrer"))},0);return()=>clearTimeout(t)}},[]);let[Q,V]=(0,p.useState)(null),[ee,et]=(0,p.useState)(null),[er,ea]=(0,p.useState)(null),[el,es]=(0,p.useState)(null),[en,eo]=(0,p.useState)(null),[ei,eu]=(0,p.useState)([]),[ed,ec]=(0,p.useState)([]),{activeOrganization:ef}=(0,d.YL)(),em=(0,p.useCallback)((e,t,r)=>F?new Promise((a,l)=>{let s={method:e,data:t,executeOperation:r,resolve:a,reject:l,artifactUuid:null==I?void 0:I.uuid};ec(e=>{var t;return(null==I?void 0:I.uuid)!==(e.length>0?null==(t=e[e.length-1])?void 0:t.artifactUuid:null)?[s]:[...e,s]})}):r(),[F,null==I?void 0:I.uuid,ec]),ep=(0,m.fS)("apps_use_turmeric"),eh=(0,m.fS)("artifact_tailwind_styles"),[eg,ey]=(0,p.useState)(0),{sendRequest:ev,updatePermission:ex}=function(e){let{iframeRef:t,allowedOrigin:r,onRateLimited:a=null,initialPermissions:l,onPermissionRequested:s,onCapabilityAction:n}=e,[o,i]=(0,p.useState)(null),u=(0,p.useRef)(l),[d,c]=(0,p.useState)(0);(0,p.useEffect)(()=>{if(!t.current&&d<20){let e=setTimeout(()=>{c(e=>e+1)},500);return()=>clearTimeout(e)}if(!t.current)return void S.v.warn(S.u.ARTIFACTS,"Max retries reached while waiting for iframe");let e=new M.x({iframe:t.current,allowedOrigin:r,onRateLimited:a,onPermissionRequested:async e=>{if(C.tH.includes(e)||"accepted"===u.current[e])return"accepted";let t=await s(e);return u.current={...u.current,[e]:t},t},onCapabilityAction:n});return i(e),()=>{e.cleanup()}},[t,r,u,a,s,n,d]);let f=(0,p.useCallback)(async(e,t)=>{if(o)return o.sendRequest(e,t);throw Error("Communicator not initialized")},[o]),m=(0,p.useCallback)(()=>{null==o||o.restartListening()},[o]),h=(0,p.useCallback)((e,t)=>{u.current={...u.current,[e]:t}},[]);return{sendRequest:null===o?void 0:f,restartListening:m,permissions:u.current,updatePermission:h}}({iframeRef:Y,allowedOrigin:B,onCapabilityAction:(0,p.useCallback)(async(e,t)=>{var r,a,l,s;if(e.method===C.uZ.ReadyForContent)return $(!0),null==f||f(),Promise.resolve();if(e.method===C.uZ.GetFile)return P&&P.getFile?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse",value:await P.getFile(e.payload.key)}:Promise.reject();if(e.method===C.uZ.SendConversationMessage)return P&&P.sendMessage?(await P.sendMessage({prompt:e.payload.message,attachments:[],files:[],syncSources:[]}),Promise.resolve()):Promise.reject();if(e.method===C.uZ.ClaudeCompletion)return P&&P.claudeComplete?(ey(e=>e+1),{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse",completion:await P.claudeComplete(e.payload.prompt)}):Promise.reject();if(e.method===C.uZ.StorageGet){if(!(null==P||null==(r=P.storage)?void 0:r.get))return Promise.reject();let t=P.storage.get,a=async()=>{let r=await t(e.payload.key,e.payload.shared);return r?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageGetResponse",key:r.key,value:r.value,shared:r.shared}:null};return em("get",e.payload,a)}else if(e.method===C.uZ.StorageSet){if(!(null==P||null==(a=P.storage)?void 0:a.set))return Promise.reject();let t=P.storage.set,r=async()=>{let r=await t(e.payload.key,e.payload.value,e.payload.shared);return r?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageSetResponse",key:r.key,value:r.value,shared:r.shared}:null},l=async()=>!0===e.payload.shared?"allow"===el?r():"deny"===el?Promise.reject():new Promise((e,t)=>{ea({onConfirm:async()=>{try{let t=await r();e(t)}catch(e){t(e)}ea(null)}})}):r();return em("set",e.payload,l)}else if(e.method===C.uZ.StorageDelete){if(!(null==P||null==(l=P.storage)?void 0:l.delete))return Promise.reject();let t=P.storage.delete,r=async()=>{let r=await t(e.payload.key,e.payload.shared);return r?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageDeleteResponse",key:r.key,deleted:r.deleted,shared:r.shared}:null},a=async()=>!0===e.payload.shared?"allow"===el?r():"deny"===el?Promise.reject():new Promise((e,t)=>{ea({onConfirm:async()=>{try{let t=await r();e(t)}catch(e){t(e)}ea(null)}})}):r();return em("delete",e.payload,a)}else if(e.method===C.uZ.StorageList){if(!(null==P||null==(s=P.storage)?void 0:s.list))return Promise.reject();let t=P.storage.list,r=async()=>{let r=await t(e.payload.prefix,e.payload.shared);return r?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageListResponse",keys:r.keys,prefix:r.prefix,shared:r.shared}:null};return em("list",e.payload,r)}else if(e.method===C.uZ.BroadcastContentSize);else if(e.method===C.uZ.DOMContentLoaded)return null==A||A(),Promise.resolve();else if(e.method===C.uZ.OpenExternal){if("ask"===Z)return V(e.payload.href),Promise.resolve();if("bubble"===Z&&T)return T({href:e.payload.href}),Promise.resolve()}else if(e.method===C.uZ.DownloadFile)return et(e.payload),Promise.resolve();else if(e.method===C.uZ.ReportError)return null==N||N(e.payload.error),Promise.resolve();else if(e.method===C.uZ.TrackInteraction)return null==_||_(e.payload),Promise.resolve();else if(e.method===C.uZ.ProxyFetch)return(null==ef?void 0:ef.uuid)?F?new Promise((r,a)=>{let l={data:e.payload,sendRequest:t,resolve:r,reject:a,artifactUuid:null==I?void 0:I.uuid};eu(e=>{var t;return(null==I?void 0:I.uuid)!==(e.length>0?null==(t=e[e.length-1])?void 0:t.artifactUuid:null)?[l]:[...e,l]})}):(0,j._)(e.payload,t,null==ef?void 0:ef.uuid,I,D,eo):(null==H||H(),Promise.reject());return Promise.reject()},[f,A,P,$,N,ey,Z,T,_,H,null==ef?void 0:ef.uuid,I,D,F,el,em]),onPermissionRequested:(0,p.useCallback)(async e=>e===C.uZ.ClaudeCompletion&&eg>=100?"denied":Promise.resolve("accepted"),[eg]),initialPermissions:{}});(0,p.useEffect)(()=>{eg>=100&&(ex(C.uZ.ClaudeCompletion,"denied"),(0,v.wd)("Claude completion request limit hit."))},[eg,ex]),(0,p.useEffect)(()=>{(async()=>{!F&&ei.length>0&&(null==ef?void 0:ef.uuid)&&(null==I?void 0:I.uuid)&&(await Promise.all(ei.map(async e=>{let{data:t,sendRequest:r,resolve:a,reject:l}=e;try{let e=await (0,j._)(t,r,ef.uuid,I,D,eo);a(e)}catch(e){l(e)}})),eu([]))})()},[F,ei,null==ef?void 0:ef.uuid,I,D]),(0,p.useEffect)(()=>{(async()=>{!F&&ed.length>0&&(null==I?void 0:I.uuid)&&(await Promise.all(ed.map(async e=>{let{executeOperation:t,resolve:r,reject:a}=e;try{let e=await t();r(e)}catch(e){a(e)}})),ec([]))})()},[F,ed,I]);let eb=(0,p.useCallback)(()=>{(0,v.wd)("Claude completion modal confirmed"),ey(0),ex(C.uZ.ClaudeCompletion,"accepted")},[ex]),ew=(0,p.useCallback)(async()=>{let e=await (null==ev?void 0:ev(C.uZ.GetScreenshot,k.qs));if(null==e?void 0:e.screenshot){if(e.screenshot.length>0xa00000)throw Error(U.formatMessage({defaultMessage:"Screenshot too large",id:"ifBuzEbIz2"}));if(!/^data:image\/(png|jpeg|gif);base64,/.test(e.screenshot))throw Error(U.formatMessage({defaultMessage:"Invalid screenshot format",id:"KCmGxpLNuq"}));return e.screenshot}},[U,ev]),eC=(0,p.useCallback)(async()=>{let e=await (null==ev?void 0:ev(C.uZ.CopyHtmlContent,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentRequest"}));return null==e?void 0:e.reportHTMLContent},[ev]),ej=(0,p.useCallback)(async()=>{let e=await (null==ev?void 0:ev(C.uZ.GetDOMSnapshot,k.qs));return(null==e?void 0:e.domSnapshot)||void 0},[ev]);return(0,p.useEffect)(()=>{z&&r&&c&&(null==R||R(),Object.values(y.vU).includes(c)?null==ev||ev(C.uZ.SetContent,{content:r,type:c,tailwindStylesEnabled:eh,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"}):null==ev||ev(C.uZ.SetContent,{content:r,type:c,tailwindStylesEnabled:eh,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"}))},[r,ev,c,z,R,eh]),(0,p.useImperativeHandle)(t,()=>({refresh:()=>{null==E||E(),$(!1);let e=Y.current;if(e){let t=e.parentNode;t?(t.removeChild(e),e.removeAttribute("src"),e.sandbox.value="allow-scripts allow-same-origin",e.setAttribute("data-no-service-worker","true"),e.setAttribute("referrerpolicy","no-referrer"),e.src=W,t.appendChild(e)):e.src=W}},getScreenshot:ew,copyHtmlContent:eC,getDOMSnapshot:ej})),(0,a.jsxs)("div",{className:(0,x.A)("relative",s),children:[(0,a.jsx)("iframe",{ref:Y,className:"h-full w-full",style:{zoom:L},sandbox:"allow-scripts allow-same-origin",title:U.formatMessage({defaultMessage:"Claude content",id:"/Ma3teJf9/"}),loading:O?"lazy":void 0,src:W,allow:"fullscreen; clipboard-write",referrerPolicy:"no-referrer"}),(0,a.jsx)(b.N,{children:!z&&(0,a.jsx)(w.P.div,{className:"bg-bg-100 absolute inset-0 z-10",initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeInOut"}})}),Q?(0,a.jsx)(u.v,{isOpen:!!Q,url:Q,onClose:()=>V(null),onConfirm:()=>{Q&&window.open(Q,"_blank"),V(null)}}):null,ee?(0,a.jsx)(i,{isOpen:!!ee,filename:ee.filename,onClose:()=>et(null),onConfirm:()=>{if(ee){let e=new Blob([ee.data],{type:ee.mimeType}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=ee.filename,r.click(),URL.revokeObjectURL(t)}et(null)}}):null,er?(0,a.jsx)(h,{isOpen:!!er,onClose:e=>{e&&es("deny"),ea(null)},onConfirm:async e=>{er&&(e&&es("allow"),await er.onConfirm())}}):null,en&&q&&I?(0,a.jsx)(q,{isOpen:!!en,requestedServers:en.requestedServers,onClose:()=>{en.onClose(),eo(null)},artifactContext:I}):null,ep&&eg>=100&&(0,a.jsx)("div",{className:"fixed inset-0 bg-always-black bg-opacity-50 flex items-center justify-center z-modal",children:(0,a.jsxs)("div",{className:"bg-bg-100 p-4 rounded shadow-lg",children:[(0,a.jsx)("p",{className:"text-fg-100 mb-4",children:(0,a.jsx)(o.A,{defaultMessage:"Many requests made. Acknowledge that you’re still here to continue.",id:"kmh/1AmVcl"})}),(0,a.jsx)(l.$,{onClick:eb,variant:"primary",children:(0,a.jsx)(o.A,{defaultMessage:"I’m still here",id:"NwhjMfjigc"})})]})})]})});A.displayName="RichSandbox"},49953:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(54568),l=r(7620);let s=(0,l.forwardRef)((e,t)=>{let{className:r,children:s,disabled:n,noDefaultScroll:o}=e,i=(0,l.useRef)(0),u=(0,l.useRef)(!0),d=(0,l.useRef)(null),c=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";if(d.current&&u.current&&!(d.current.scrollHeight-d.current.clientHeight<d.current.scrollTop)&&d.current&&"function"==typeof d.current.scrollTo){var t,r,a;null==(a=d.current)||a.scrollTo({top:(null==(t=d.current)?void 0:t.scrollHeight)-(null==(r=d.current)?void 0:r.clientHeight)+5,behavior:e})}},[]),f=(0,l.useCallback)(e=>{if(d.current&&d.current&&"function"==typeof d.current.scrollTo){var t,r,a;d.current.style.overflow="hidden",null==(a=d.current)||a.scrollTo({top:(null==(t=d.current)?void 0:t.scrollHeight)*e-(null==(r=d.current)?void 0:r.clientHeight)/2,behavior:"auto"})}},[]),m=(0,l.useCallback)(()=>{d.current&&(d.current.style.overflow="")},[]);return(0,l.useImperativeHandle)(t,()=>({reset(){i.current=0,u.current=!0,o||c()},scrollToBottomIfPinned:c,scrollToPercentage:f,enableScrolling:m,getScrollContainer:()=>d.current}),[c,f,m,o]),(0,l.useLayoutEffect)(()=>{n||!s||o||c()},[s,n,c,o]),(0,a.jsx)("div",{className:r,onScroll:e=>{if(n)return;let t=e.currentTarget.scrollTop,r=function(e,t){if(!e)return!1;{let r=e.scrollHeight-8;return Math.ceil(t+e.offsetHeight)>=Math.floor(r)}}(d.current,t),a=t>i.current;r&&a?u.current=!0:r||a||(u.current=!1),i.current=t},ref:d,children:s})});s.displayName="AutoScroll"}}]);